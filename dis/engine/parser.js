"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.limiter=limiter,exports.parseCode=parseCode;var _executor=require("./executor"),limiters=new Map;function limiter(a,b){if("string"!=typeof a)throw new TypeError("First argument must be a string.");if("function"!=typeof b)throw new TypeError("Second argument must be a function.");if(limiters.has(a))throw new Error("A limiter named ".concat(a," is already registered."));return limiters.set(a,b),this}var limiterRegex=/(?:[^&]|&&)+/g,argsRegex=/\S+/g;function parseCode(a,b){var c=a.match(limiterRegex);if(1===c.length)return(0,_executor.executorCode)(c[0],b);for(var d={exec:(0,_executor.executorCode)(c[0],b),limiters:[]},e=1;e<c.length;e++){var f=c[e].match(argsRegex),g=f.shift(),h=limiters.get(g);if(!h)throw new Error("There is no limiter named: ".concat(g,"."));d.limiters.push({effect:h,argExpressions:f.map(_executor.executorCode)})}return d}